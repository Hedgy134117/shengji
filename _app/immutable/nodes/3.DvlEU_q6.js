import{s as W,n as p}from"../chunks/scheduler.CQ0VQmrD.js";import{S as X,i as Y,e as k,s as I,t as L,c as b,a as D,d as _,f as V,b as N,m as x,g as P,h as v,j as B,o as z,p as T,k as ee,q as O,r as A,l as Z,u as te,v as le,w as ae,x as se,y as ne}from"../chunks/index._ZaFpx5m.js";import{e as S,s as j,h as oe,u as re,P as ce,G,d as ie}from"../chunks/GameList.C_BHhpbF.js";function M(o,e,a){const t=o.slice();return t[3]=e[a],t[5]=a,t}function U(o,e,a){const t=o.slice();return t[6]=e[a],t}function H(o,e,a){const t=o.slice();return t[3]=e[a],t[5]=a,t}function K(o){let e,a=o[3].name+"",t;return{c(){e=k("p"),t=L(a),this.h()},l(l){e=b(l,"P",{class:!0});var n=D(e);t=N(n,a),n.forEach(_),this.h()},h(){x(e,"class","player-name win-"+o[2][o[5]]+" svelte-1sxqnmd")},m(l,n){P(l,e,n),v(e,t)},p(l,n){n&1&&a!==(a=l[3].name+"")&&B(t,a)},d(l){l&&_(e)}}}function Q(o){let e,a=j(o[6][0])+"",t,l;return{c(){e=k("p"),t=L(a),l=I(),this.h()},l(n){e=b(n,"P",{class:!0});var c=D(e);t=N(c,a),l=V(c),c.forEach(_),this.h()},h(){x(e,"class","svelte-1sxqnmd"),T(e,"staged",o[6][1])},m(n,c){P(n,e,c),v(e,t),v(e,l)},p,d(n){n&&_(e)}}}function R(o){let e,a=j(o[0].scores[o[5]])+"",t;return{c(){e=k("p"),t=L(a),this.h()},l(l){e=b(l,"P",{class:!0});var n=D(e);t=N(n,a),n.forEach(_),this.h()},h(){x(e,"class","svelte-1sxqnmd"),T(e,"staged",o[0].staged[o[5]])},m(l,n){P(l,e,n),v(e,t)},p(l,n){n&1&&a!==(a=j(l[0].scores[l[5]])+"")&&B(t,a),n&1&&T(e,"staged",l[0].staged[l[5]])},d(l){l&&_(e)}}}function he(o){let e,a,t,l,n,c,$,E,u=o[0].date.toDateString()+"",h,f=S(o[0].players),i=[];for(let r=0;r<f.length;r+=1)i[r]=K(H(o,f,r));let C=S(o[1]),m=[];for(let r=0;r<C.length;r+=1)m[r]=Q(U(o,C,r));let w=S(o[0].players),g=[];for(let r=0;r<w.length;r+=1)g[r]=R(M(o,w,r));return{c(){e=k("div"),a=k("div");for(let r=0;r<i.length;r+=1)i[r].c();t=I(),l=k("div");for(let r=0;r<m.length;r+=1)m[r].c();n=I(),c=k("div");for(let r=0;r<g.length;r+=1)g[r].c();$=I(),E=k("p"),h=L(u),this.h()},l(r){e=b(r,"DIV",{class:!0});var d=D(e);a=b(d,"DIV",{class:!0});var s=D(a);for(let y=0;y<i.length;y+=1)i[y].l(s);s.forEach(_),t=V(d),l=b(d,"DIV",{class:!0});var q=D(l);for(let y=0;y<m.length;y+=1)m[y].l(q);q.forEach(_),n=V(d),c=b(d,"DIV",{class:!0});var F=D(c);for(let y=0;y<g.length;y+=1)g[y].l(F);F.forEach(_),$=V(d),E=b(d,"P",{class:!0});var J=D(E);h=N(J,u),J.forEach(_),d.forEach(_),this.h()},h(){x(a,"class","equal-fill players svelte-1sxqnmd"),x(l,"class","equal-fill prev-scores svelte-1sxqnmd"),x(c,"class","equal-fill post-scores svelte-1sxqnmd"),x(E,"class","date svelte-1sxqnmd"),x(e,"class","game svelte-1sxqnmd")},m(r,d){P(r,e,d),v(e,a);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(a,null);v(e,t),v(e,l);for(let s=0;s<m.length;s+=1)m[s]&&m[s].m(l,null);v(e,n),v(e,c);for(let s=0;s<g.length;s+=1)g[s]&&g[s].m(c,null);v(e,$),v(e,E),v(E,h)},p(r,[d]){if(d&5){f=S(r[0].players);let s;for(s=0;s<f.length;s+=1){const q=H(r,f,s);i[s]?i[s].p(q,d):(i[s]=K(q),i[s].c(),i[s].m(a,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=f.length}if(d&2){C=S(r[1]);let s;for(s=0;s<C.length;s+=1){const q=U(r,C,s);m[s]?m[s].p(q,d):(m[s]=Q(q),m[s].c(),m[s].m(l,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=C.length}if(d&1){w=S(r[0].players);let s;for(s=0;s<w.length;s+=1){const q=M(r,w,s);g[s]?g[s].p(q,d):(g[s]=R(q),g[s].c(),g[s].m(c,null))}for(;s<g.length;s+=1)g[s].d(1);g.length=w.length}d&1&&u!==(u=r[0].date.toDateString()+"")&&B(h,u)},i:p,o:p,d(r){r&&_(e),z(i,r),z(m,r),z(g,r)}}}function fe(o,e,a){let{game:t}=e,l=[];for(let c of t.players)l.push(t.getPlayerPreviousScoreStage(c));let n=t.getScoreDifference();return o.$$set=c=>{"game"in c&&a(0,t=c.game)},[t,l,n]}class ue extends X{constructor(e){super(),Y(this,e,fe,he,W,{game:0})}}function _e(o,e,a){const t=o.slice();return t[3]=e[a],t}function de(o){return{c:p,l:p,m:p,p,i:p,o:p,d:p}}function me(o){let e,a,t,l="Export to JSON",n,c,$,E=S(G.games.reverse()),u=[];for(let h=0;h<E.length;h+=1)u[h]=ge(_e(o,E,h));return{c(){e=k("div");for(let h=0;h<u.length;h+=1)u[h].c();a=I(),t=k("button"),t.textContent=l,this.h()},l(h){e=b(h,"DIV",{class:!0});var f=D(e);for(let i=0;i<u.length;i+=1)u[i].l(f);a=V(f),t=b(f,"BUTTON",{"data-svelte-h":!0}),Z(t)!=="svelte-p7y6s1"&&(t.textContent=l),f.forEach(_),this.h()},h(){x(e,"class","game-list")},m(h,f){P(h,e,f);for(let i=0;i<u.length;i+=1)u[i]&&u[i].m(e,null);v(e,a),v(e,t),n=!0,c||($=te(t,"click",o[1]),c=!0)},p,i(h){if(!n){for(let f=0;f<E.length;f+=1)O(u[f]);n=!0}},o(h){u=u.filter(Boolean);for(let f=0;f<u.length;f+=1)A(u[f]);n=!1},d(h){h&&_(e),z(u,h),c=!1,$()}}}function ge(o){let e,a;return e=new ue({props:{game:o[3]}}),{c(){le(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,l){se(e,t,l),a=!0},p,i(t){a||(O(e.$$.fragment,t),a=!0)},o(t){A(e.$$.fragment,t),a=!1},d(t){ne(e,t)}}}function pe(o){let e,a="Loading Data";return{c(){e=k("p"),e.textContent=a},l(t){e=b(t,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-14rifgg"&&(e.textContent=a)},m(t,l){P(t,e,l)},p,i:p,o:p,d(t){t&&_(e)}}}function ve(o){let e,a,t,l={ctx:o,current:null,token:null,hasCatch:!1,pending:pe,then:me,catch:de,blocks:[,,,]};return oe(o[0](),l),{c(){e=I(),a=k("main"),l.block.c(),this.h()},l(n){ee("svelte-vimel9",document.head).forEach(_),e=V(n),a=b(n,"MAIN",{});var $=D(a);l.block.l($),$.forEach(_),this.h()},h(){document.title="shengji games"},m(n,c){P(n,e,c),P(n,a,c),l.block.m(a,l.anchor=null),l.mount=()=>a,l.anchor=null,t=!0},p(n,[c]){o=n,re(l,o,c)},i(n){t||(O(l.block),t=!0)},o(n){for(let c=0;c<3;c+=1){const $=l.blocks[c];A($)}t=!1},d(n){n&&(_(e),_(a)),l.block.d(),l.token=null,l=null}}}function ke(o){async function e(){return await ce.initialize(),G.initialize().then(()=>G.games[1])}function a(){let t=[];for(let l=0;l<G.games.length;l++){let n=G.games[l];t.push({date:n.date,players:n.players.map(c=>c.name),scores:n.scores,staged:n.staged})}ie(t,"games")}return[e,a]}class ye extends X{constructor(e){super(),Y(this,e,ke,ve,W,{})}}export{ye as component};
