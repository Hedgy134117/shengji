import{s as x,n as v}from"../chunks/scheduler.CQ0VQmrD.js";import{S as G,i as N,e as b,t as C,s as E,c as S,a as P,b as w,d as _,f as A,k,m as V,g as y,h as m,j as q,l as j,y as J,u as R,v as L,A as U,w as M,o as B,p as I,x as T,n as ee,q as Z,r as te}from"../chunks/index.B_jzJh3r.js";import{s as D,e as $,h as se,u as le,P as W,G as re,d as ae}from"../chunks/GameList.CipN0kEP.js";function H(a,e,s){const t=a.slice();return t[4]=e[s],t}function K(a){let e,s=D(a[4][0])+"",t,l;return{c(){e=b("p"),t=C(s),l=E(),this.h()},l(i){e=S(i,"P",{class:!0});var r=P(e);t=w(r,s),l=A(r),r.forEach(_),this.h()},h(){k(e,"class","score svelte-18boys0"),V(e,"score__staged",a[4][1])},m(i,r){y(i,e,r),m(e,t),m(e,l)},p(i,r){r&8&&s!==(s=D(i[4][0])+"")&&q(t,s),r&8&&V(e,"score__staged",i[4][1])},d(i){i&&_(e)}}}function ne(a){let e,s,t=D(a[2])+"",l,i,r,h,g,u=D(a[1])+"",n,o=$(a[3].reverse()),c=[];for(let f=0;f<o.length;f+=1)c[f]=K(H(a,o,f));return{c(){e=b("div"),s=b("p"),l=C(t),i=E(),r=b("div");for(let f=0;f<c.length;f+=1)c[f].c();h=E(),g=b("p"),n=C(u),this.h()},l(f){e=S(f,"DIV",{class:!0});var p=P(e);s=S(p,"P",{class:!0});var d=P(s);l=w(d,t),d.forEach(_),i=A(p),r=S(p,"DIV",{class:!0});var z=P(r);for(let O=0;O<c.length;O+=1)c[O].l(z);z.forEach(_),h=A(p),g=S(p,"P",{class:!0});var F=P(g);n=w(F,u),F.forEach(_),p.forEach(_),this.h()},h(){k(s,"class","score score__curent svelte-18boys0"),V(s,"score__staged",a[0]),k(r,"class","score-list svelte-18boys0"),k(g,"class","score score__start svelte-18boys0"),k(e,"class","scores svelte-18boys0")},m(f,p){y(f,e,p),m(e,s),m(s,l),m(e,i),m(e,r);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(r,null);m(e,h),m(e,g),m(g,n)},p(f,[p]){if(p&4&&t!==(t=D(f[2])+"")&&q(l,t),p&1&&V(s,"score__staged",f[0]),p&8){o=$(f[3].reverse());let d;for(d=0;d<o.length;d+=1){const z=H(f,o,d);c[d]?c[d].p(z,p):(c[d]=K(z),c[d].c(),c[d].m(r,null))}for(;d<c.length;d+=1)c[d].d(1);c.length=o.length}p&2&&u!==(u=D(f[1])+"")&&q(n,u)},i:v,o:v,d(f){f&&_(e),j(c,f)}}}function oe(a,e,s){let{isStaged:t}=e,{start:l}=e,{score:i}=e,{scoresAndStaged:r}=e;return a.$$set=h=>{"isStaged"in h&&s(0,t=h.isStaged),"start"in h&&s(1,l=h.start),"score"in h&&s(2,i=h.score),"scoresAndStaged"in h&&s(3,r=h.scoresAndStaged)},[t,l,i,r]}class ie extends G{constructor(e){super(),N(this,e,oe,ne,x,{isStaged:0,start:1,score:2,scoresAndStaged:3})}}function Q(a,e,s){const t=a.slice();return t[3]=e[s],t[5]=s,t}function X(a){let e,s=$(a[2]),t=[];for(let l=0;l<s.length;l+=1)t[l]=Y(Q(a,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=J()},l(l){for(let i=0;i<t.length;i+=1)t[i].l(l);e=J()},m(l,i){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,i);y(l,e,i)},p(l,i){if(i&4){s=$(l[2]);let r;for(r=0;r<s.length;r+=1){const h=Q(l,s,r);t[r]?t[r].p(h,i):(t[r]=Y(),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=s.length}},d(l){l&&_(e),j(t,l)}}}function Y(a){let e;return{c(){e=b("progress"),this.h()},l(s){e=S(s,"PROGRESS",{max:!0,class:!0}),P(e).forEach(_),this.h()},h(){e.value="1",k(e,"max","1"),k(e,"class","svelte-h8qevh")},m(s,t){y(s,e,t)},p:v,d(s){s&&_(e)}}}function ce(a){let e,s=Math.round(a[0]*100)+"",t,l,i=a[1]+1+"",r,h,g,u,n,o=a[2]!==null&&X(a);return{c(){e=b("p"),t=C(s),l=C("% to P"),r=C(i),h=E(),g=b("div"),o&&o.c(),u=E(),n=b("progress"),this.h()},l(c){e=S(c,"P",{class:!0});var f=P(e);t=w(f,s),l=w(f,"% to P"),r=w(f,i),f.forEach(_),h=A(c),g=S(c,"DIV",{class:!0});var p=P(g);o&&o.l(p),u=A(p),n=S(p,"PROGRESS",{max:!0,class:!0}),P(n).forEach(_),p.forEach(_),this.h()},h(){k(e,"class","prestige svelte-h8qevh"),n.value=a[0],k(n,"max","1"),k(n,"class","svelte-h8qevh"),k(g,"class","prestige-bars")},m(c,f){y(c,e,f),m(e,t),m(e,l),m(e,r),y(c,h,f),y(c,g,f),o&&o.m(g,null),m(g,u),m(g,n)},p(c,[f]){f&1&&s!==(s=Math.round(c[0]*100)+"")&&q(t,s),f&2&&i!==(i=c[1]+1+"")&&q(r,i),c[2]!==null?o?o.p(c,f):(o=X(c),o.c(),o.m(g,u)):o&&(o.d(1),o=null),f&1&&(n.value=c[0])},i:v,o:v,d(c){c&&(_(e),_(h),_(g)),o&&o.d()}}}function fe(a,e,s){let{progress:t}=e,{prestige:l}=e,i=null;return l>0&&(i=Array.from(" ".repeat(l))),a.$$set=r=>{"progress"in r&&s(0,t=r.progress),"prestige"in r&&s(1,l=r.prestige)},[t,l,i]}class ue extends G{constructor(e){super(),N(this,e,fe,ce,x,{progress:0,prestige:1})}}function he(a){let e,s,t=a[0].name+"",l,i,r,h,g,u;return r=new ie({props:{isStaged:a[0].isStaged(),start:a[0].start,score:a[0].getScore(),scoresAndStaged:a[0].getScoresWithStaged()}}),g=new ue({props:{progress:a[0].getProgress(),prestige:a[0].getPrestige()}}),{c(){e=b("div"),s=b("p"),l=C(t),i=E(),R(r.$$.fragment),h=E(),R(g.$$.fragment),this.h()},l(n){e=S(n,"DIV",{class:!0});var o=P(e);s=S(o,"P",{class:!0,style:!0});var c=P(s);l=w(c,t),c.forEach(_),i=A(o),L(r.$$.fragment,o),h=A(o),L(g.$$.fragment,o),o.forEach(_),this.h()},h(){k(s,"class","player-name svelte-1r9zgva"),U(s,"border",a[0].getPrestige()+"px solid var(--accent-color)"),k(e,"class","player-box svelte-1r9zgva")},m(n,o){y(n,e,o),m(e,s),m(s,l),m(e,i),M(r,e,null),m(e,h),M(g,e,null),u=!0},p(n,[o]){(!u||o&1)&&t!==(t=n[0].name+"")&&q(l,t),(!u||o&1)&&U(s,"border",n[0].getPrestige()+"px solid var(--accent-color)");const c={};o&1&&(c.isStaged=n[0].isStaged()),o&1&&(c.start=n[0].start),o&1&&(c.score=n[0].getScore()),o&1&&(c.scoresAndStaged=n[0].getScoresWithStaged()),r.$set(c);const f={};o&1&&(f.progress=n[0].getProgress()),o&1&&(f.prestige=n[0].getPrestige()),g.$set(f)},i(n){u||(B(r.$$.fragment,n),B(g.$$.fragment,n),u=!0)},o(n){I(r.$$.fragment,n),I(g.$$.fragment,n),u=!1},d(n){n&&_(e),T(r),T(g)}}}function ge(a,e,s){let{player:t}=e;return a.$$set=l=>{"player"in l&&s(0,t=l.player)},[t]}class _e extends G{constructor(e){super(),N(this,e,ge,he,x,{player:0})}}function de(a,e,s){const t=a.slice();return t[2]=e[s],t}function pe(a){return{c:v,l:v,m:v,p:v,i:v,o:v,d:v}}function me(a){let e,s,t,l="Export to JSON",i,r,h,g=$(W.players),u=[];for(let n=0;n<g.length;n+=1)u[n]=ve(de(a,g,n));return{c(){e=b("div");for(let n=0;n<u.length;n+=1)u[n].c();s=E(),t=b("button"),t.textContent=l,this.h()},l(n){e=S(n,"DIV",{class:!0});var o=P(e);for(let c=0;c<u.length;c+=1)u[c].l(o);o.forEach(_),s=A(n),t=S(n,"BUTTON",{"data-svelte-h":!0}),Z(t)!=="svelte-p7y6s1"&&(t.textContent=l),this.h()},h(){k(e,"class","player-box-list")},m(n,o){y(n,e,o);for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(e,null);y(n,s,o),y(n,t,o),i=!0,r||(h=te(t,"click",a[1]),r=!0)},p:v,i(n){if(!i){for(let o=0;o<g.length;o+=1)B(u[o]);i=!0}},o(n){u=u.filter(Boolean);for(let o=0;o<u.length;o+=1)I(u[o]);i=!1},d(n){n&&(_(e),_(s),_(t)),j(u,n),r=!1,h()}}}function ve(a){let e,s;return e=new _e({props:{player:a[2]}}),{c(){R(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,l){M(e,t,l),s=!0},p:v,i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){I(e.$$.fragment,t),s=!1},d(t){T(e,t)}}}function be(a){let e,s="Loading Data";return{c(){e=b("p"),e.textContent=s},l(t){e=S(t,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-14rifgg"&&(e.textContent=s)},m(t,l){y(t,e,l)},p:v,i:v,o:v,d(t){t&&_(e)}}}function Se(a){let e,s,t,l={ctx:a,current:null,token:null,hasCatch:!1,pending:be,then:me,catch:pe,blocks:[,,,]};return se(a[0](),l),{c(){e=E(),s=b("main"),l.block.c(),this.h()},l(i){ee("svelte-1q4z6de",document.head).forEach(_),e=A(i),s=S(i,"MAIN",{});var h=P(s);l.block.l(h),h.forEach(_),this.h()},h(){document.title="shengji players"},m(i,r){y(i,e,r),y(i,s,r),l.block.m(s,l.anchor=null),l.mount=()=>s,l.anchor=null,t=!0},p(i,[r]){a=i,le(l,a,r)},i(i){t||(B(l.block),t=!0)},o(i){for(let r=0;r<3;r+=1){const h=l.blocks[r];I(h)}t=!1},d(i){i&&(_(e),_(s)),l.block.d(),l.token=null,l=null}}}function ke(a){async function e(){return await W.initialize(),re.initialize()}function s(){let t={};for(let l of W.players)t[l.name]={},t[l.name].history=l.getScoresWithStaged(),t[l.name].prestige=l.getPrestige();ae(t,"players")}return[e,s]}class Ae extends G{constructor(e){super(),N(this,e,ke,Se,x,{})}}export{Ae as component};
